{"ast":null,"code":"import { of, switchMap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthServicio {\n  constructor(_http) {\n    this._http = _http;\n    //private url: string = 'http://cursoangular.ci4.cognox.com/Api00/Autorizacion/';\n    /** Propiedad Autenticación */\n    this._authenticated = false;\n    this.url = 'Autorizacion/';\n    /** Propiedad configuración */\n    this.configSession = 'Peliculas';\n  }\n  set session(auth) {\n    localStorage.setItem(this.configSession, JSON.stringify(auth));\n  }\n  get session() {\n    if (localStorage.getItem(this.configSession) === undefined) {\n      //cerrar\n    }\n    const sessionJson = localStorage.getItem(this.configSession);\n    const session = sessionJson !== null ? JSON.parse(sessionJson) : null;\n    return session;\n  }\n  get token() {\n    const sessionJson = localStorage.getItem(this.configSession);\n    const session = sessionJson !== null ? JSON.parse(sessionJson) : null;\n    return session.Token;\n  }\n  Login(login) {\n    let body = JSON.stringify(login);\n    const url = `${this.url}Autenticacion`;\n    return this._http.post(url, body).pipe(switchMap(response => {\n      if (response.Mensaje.Estado) {\n        // Asigna información del token\n        this.session = response.Datos;\n        // Indica que usuario es autenticado\n        this._authenticated = true;\n      }\n      // Return a new observable with the response\n      return of(response);\n    }));\n  }\n}\nAuthServicio.ɵfac = function AuthServicio_Factory(t) {\n  return new (t || AuthServicio)(i0.ɵɵinject(i1.HttpClient));\n};\nAuthServicio.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthServicio,\n  factory: AuthServicio.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AAEA,SAAqBA,EAAE,EAAEC,SAAS,QAAQ,MAAM;;;AAWhD,OAAM,MAAOC,YAAY;EAYrBC,YAAoBC,KAAiB;IAAjB,UAAK,GAALA,KAAK;IAVzB;IACA;IACQ,mBAAc,GAAY,KAAK;IAE/B,QAAG,GAAW,eAAe;IAErC;IACQ,kBAAa,GAAW,WAAW;EAI3C;EAGA,IAAIC,OAAO,CAACC,IAAkB;IAC1BC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACC,aAAa,EAAEC,IAAI,CAACC,SAAS,CAACL,IAAI,CAAC,CAAC;EAClE;EAEA,IAAID,OAAO;IACP,IAAIE,YAAY,CAACK,OAAO,CAAC,IAAI,CAACH,aAAa,CAAC,KAAKI,SAAS,EAAE;MACxD;IAAA;IAEJ,MAAMC,WAAW,GAAGP,YAAY,CAACK,OAAO,CAAC,IAAI,CAACH,aAAa,CAAC;IAC5D,MAAMJ,OAAO,GAAiBS,WAAW,KAAK,IAAI,GAAGJ,IAAI,CAACK,KAAK,CAACD,WAAW,CAAC,GAAG,IAAI;IACnF,OAAOT,OAAO;EAClB;EAEA,IAAIW,KAAK;IACL,MAAMF,WAAW,GAAGP,YAAY,CAACK,OAAO,CAAC,IAAI,CAACH,aAAa,CAAC;IAC5D,MAAMJ,OAAO,GAAiBS,WAAW,KAAK,IAAI,GAAGJ,IAAI,CAACK,KAAK,CAACD,WAAW,CAAC,GAAG,IAAI;IACnF,OAAOT,OAAO,CAACY,KAAM;EACzB;EAGAC,KAAK,CAACC,KAAY;IAEd,IAAIC,IAAI,GAAGV,IAAI,CAACC,SAAS,CAACQ,KAAK,CAAC;IAChC,MAAME,GAAG,GAAG,GAAG,IAAI,CAACA,GAAG,eAAe;IAEtC,OAAO,IAAI,CAACjB,KAAK,CAACkB,IAAI,CAAeD,GAAG,EAAED,IAAI,CAAC,CAC1CG,IAAI,CACDtB,SAAS,CAAEuB,QAAsB,IAAI;MAEjC,IAAIA,QAAQ,CAACC,OAAO,CAACC,MAAM,EAAE;QAEzB;QACA,IAAI,CAACrB,OAAO,GAAGmB,QAAQ,CAACG,KAAK;QAE7B;QACA,IAAI,CAACC,cAAc,GAAG,IAAI;;MAE9B;MACA,OAAO5B,EAAE,CAACwB,QAAQ,CAAC;IAEvB,CAAC,CAAC,CACL;EACT;;AA1DStB,YAAY;mBAAZA,YAAY;AAAA;AAAZA,YAAY;SAAZA,YAAY;EAAA2B,SAAZ3B,YAAY;EAAA4B,YAFT;AAAM","names":["of","switchMap","AuthServicio","constructor","_http","session","auth","localStorage","setItem","configSession","JSON","stringify","getItem","undefined","sessionJson","parse","token","Token","Login","login","body","url","post","pipe","response","Mensaje","Estado","Datos","_authenticated","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\chrod\\OneDrive\\Documentos\\RepositoriosConvertic\\juan Camilo\\clase05\\src\\app\\servicios\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\n\r\n/** Interfaces */\r\nimport { Login } from '../interface/login';\r\nimport { RespuestaApi } from '../interface/respuestaapi';\r\nimport { environment } from 'src/environments/environment';\r\nimport { Autorizacion } from '../interface/autorizacion';\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class AuthServicio {\r\n\r\n    //private url: string = 'http://cursoangular.ci4.cognox.com/Api00/Autorizacion/';\r\n    /** Propiedad Autenticación */\r\n    private _authenticated: boolean = false;\r\n\r\n    private url: string = 'Autorizacion/';\r\n\r\n    /** Propiedad configuración */\r\n    private configSession: string = 'Peliculas';\r\n\r\n\r\n    constructor(private _http: HttpClient) {\r\n    }\r\n\r\n\r\n    set session(auth: Autorizacion) {\r\n        localStorage.setItem(this.configSession, JSON.stringify(auth));\r\n    }\r\n\r\n    get session(): Autorizacion {\r\n        if (localStorage.getItem(this.configSession) === undefined) {\r\n            //cerrar\r\n        }\r\n        const sessionJson = localStorage.getItem(this.configSession);\r\n        const session: Autorizacion = sessionJson !== null ? JSON.parse(sessionJson) : null;\r\n        return session;\r\n    }\r\n\r\n    get token(): string {\r\n        const sessionJson = localStorage.getItem(this.configSession);\r\n        const session: Autorizacion = sessionJson !== null ? JSON.parse(sessionJson) : null;\r\n        return session.Token!;\r\n    }\r\n\r\n\r\n    Login(login: Login): Observable<any> {\r\n\r\n        let body = JSON.stringify(login);\r\n        const url = `${this.url}Autenticacion`;\r\n\r\n        return this._http.post<RespuestaApi>(url, body)\r\n            .pipe(\r\n                switchMap((response: RespuestaApi) => {\r\n\r\n                    if (response.Mensaje.Estado) {\r\n\r\n                        // Asigna información del token\r\n                        this.session = response.Datos;\r\n\r\n                        // Indica que usuario es autenticado\r\n                        this._authenticated = true;\r\n                    }\r\n                    // Return a new observable with the response\r\n                    return of(response);\r\n\r\n                })\r\n            );\r\n    }\r\n\r\n\r\n\r\n\r\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}